---
- name: install wireguard
  hosts: all
  become: true

  roles:
    - role: wireguard_install
      vars:
        wg_package_list:
          - wireguard
          - iptables
          - resolvconf
        wg_public_ip: 130.61.100.237
        wg_public_nic: enp0s3
        wg_nic: wg0
        wg_ipv4: 172.16.16.1
        wg_port: 51094
        wg_private_key: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          36383539373433373936336363613932613762313833346135656361316339363266393362623536
          6132636435306162613035646438306466323564663431310a656161303665623034643739393530
          65663438326435653965643566336262313566613831643537633465643934303234376434626237
          6431613838666665640a383534376561373466613465653934383832333363313935303766636538
          64633436333434666263656234323836623862323037336235363364633661326363393138353661
          6339616362383865643535336433376665383561636238633639
        wg_public_key: yMfsaqqliN6BYVd2n3eFce4hW2tZCF6aKcn4Ixg5+hI=
    - role: wireguard_users
      vars:
        wg_public_ip: 130.61.100.237
        wg_nic:  wg0
        wg_port: 51094
        allowed_ips: 0.0.0.0/0
        wg_conf_dir: /etc/wireguard
        client_dns:
          - 8.8.8.8
          - 1.1.1.1
        wg_user_list:
          user_1:
            wg_user_private_ip: 172.16.16.2
            wg_user_private_key: !vault |
                  $ANSIBLE_VAULT;1.1;AES256
                  32333835343131643134323131613135383935346330626531636635666537333130316337616361
                  6435363734373532396135656436633432316332653333390a346536626161306339376161373964
                  33383134653231333738626366663530303765356137396666343336323861333530303531656231
                  3932343161636465640a663266363931643830646661303531633238643665303035323731626565
                  36646137363037643732336366373866323062313535313132646463333033623462353330643064
                  3464386632356533343834633438356538353739613666353433
            wg_user_public_key: 1sbKjqSRYDUMKC8+hfe/8r2WWhzC2SZl75X05FjzQCA=
            remove: false
          user_2:
            wg_user_private_ip: 172.16.16.3
            wg_user_private_key: !vault |
                  $ANSIBLE_VAULT;1.1;AES256
                  64633062316366303934323035336339613931326165376538363535306630626631343434626533
                  3833643530303066623239386663376461613661373934660a633337373937653662326133363363
                  39366536373566373931653966306631643061396562343163356531663036326235346236666264
                  3534343662316663640a396534333833343337626136313064623934393137633837613331383364
                  64333433653565623362613261653665333334653733613665356634353339653963643063613930
                  6262376665653963643536616363366633663361313037666663
            wg_user_public_key: T9/zM5VWJJyL+QN8rS6dYyVC6D7KwiysX2MdvLgrZg8=
            remove: false
          user_3:
            wg_user_private_ip: 172.16.16.4
            wg_user_private_key: !vault |
                  $ANSIBLE_VAULT;1.1;AES256
                  61333965396535396264376332393232643966373634373566646165616339346232336632663165
                  3930656565376630336630336663316265663634633136630a373732663232326535323730303831
                  61333765616564313233613531656431623766356430613632363463306636656161346231353465
                  6334343938396136630a396434666361363165376662373831373564323466353732633164653234
                  64366331636361396561653437626465653664393231376437313162333631356133333163356231
                  3738396137633935643761626330383562666364623835636430
            wg_user_public_key: 7vf0i5loxiWW5werTdUZ9ek47e4n2GbSsZW/M4OqGVA=
            remove: false
          user_4:
            wg_public_ip: 130.61.100.237
            wg_user_private_ip: 172.16.16.5
            wg_user_private_key: !vault |
                  $ANSIBLE_VAULT;1.1;AES256
                  61336236643730383132643262366331626163653633333263626162616532333438343032646332
                  3064633764303064303238363331626462323430633965380a326161643535663735366235366237
                  35336562626232303563303932316331333736656130386639636564333734336562623339356336
                  3230313837623466650a626362323662333535383838653166323439306636396535336435393235
                  34313764613766346432613236353961643536336161373965623435363266613238646137363263
                  6531623235313365343635643938313431643231656563393334
            wg_user_public_key: RyGLaBAthuOm2fJHyHRdUUlzBvBDcyerkiaROdgnglA=
            remove: false
          user_5:
            wg_user_private_ip: 172.16.16.6
            wg_user_private_key: !vault |
                  $ANSIBLE_VAULT;1.1;AES256
                  61643239623730386364366538646361653635306131613331346533393566356631333062363865
                  3731656166393165303738663764666638646434306264650a663734313265323032336262626138
                  64663738353364323530653436366636636463333965373965333732383161393365323432316464
                  3566646639383231350a623566643461316535656332356461313837363765313936343531393538
                  30376463386438636638303434343237343563663330396239306663613464363564316161346361
                  3461666232323630633732663736333832323733633934666531
            wg_user_public_key: OHiQnKPmThaiNgBnsTxRhWlcDHCHL8eRIW0uHRfEQnQ=
            remove: false
          user_6:
            wg_user_private_ip: 172.16.16.7
            wg_user_private_key: !vault |
                  $ANSIBLE_VAULT;1.1;AES256
                  36383036363435383566326333346332303037643139333033306361633135376131383733313963
                  3766656631383739333639646235303466313265653037630a373031316661343935636633323731
                  32653437333836633535353461633235643133333339646232616336383136366132363831326164
                  3532333739646165320a643661396530303433613233636535663963633763326139303762636138
                  39353564656438646137336666353835353037643538646232326432616164666665613735623139
                  6339333630366235653330613531663439333438633564333332
            wg_user_public_key: bJpYvmDoGdG8kg1zM+1sn3FQyZjr6aWErg1VhdXMEzo=
            remove: false
